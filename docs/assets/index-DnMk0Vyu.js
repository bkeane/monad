import{c as p,o as u,a as O,b as t,n as z,t as w,r as d,d as v,e as r,F as M,f as D,g as C,h as S,i as $,j as I,k as B}from"./@vue-DB8R4fXx.js";/* empty css                 */import{H as A,b as x,d as K}from"./highlight.js-D4wtHl8c.js";import{e as f}from"./endent-Clm5LqZb.js";import"./dedent-DLT5raRU.js";import"./objectorarray-BuWbUJTR.js";import"./fast-json-parse-CjGQNN3V.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const c=(i,e)=>{const a=i.__vccOpts||i;for(const[l,n]of e)a[l]=n;return a},j={};function q(i,e){return u(),p("div",null,e[0]||(e[0]=[O('<article data-v-8967bb24>Monad is a tool for deploying OCI image based services to AWS.</article><h3 data-v-8967bb24>Three Factor Deployments</h3><p data-v-8967bb24> Monad uses convention to reduce the number of factors necessary for deploying an application from <a href="https://12factor.net/" data-v-8967bb24>twelve factors</a> to three. </p> The remaining factors are: <ol data-v-8967bb24><li data-v-8967bb24><strong data-v-8967bb24>Codebase</strong> - A git repository. </li><li data-v-8967bb24><strong data-v-8967bb24>Dependencies</strong> - ECR image/s. </li><li data-v-8967bb24><strong data-v-8967bb24>Configuration</strong> - Environment variables. </li></ol><h3 data-v-8967bb24>Design Principles</h3><h5 data-v-8967bb24>Single Binary</h5><p data-v-8967bb24> Monad is a single binary that can be used directly from developer machines and from CI/CD pipelines. </p><h5 data-v-8967bb24>Git Ops</h5><p data-v-8967bb24> Monad uses conventions on top of git to allow all services on all branches to be deployed at any given time without conflict. All resources generated by Monad are tagged with git provenance data and all resource naming is likewise git interpolated. </p><h5 data-v-8967bb24>OCI Artifact</h5><p data-v-8967bb24> The deployable artifact of Monad is an OCI compliant container image hosted on ECR. </p><h5 data-v-8967bb24>No State File</h5><p data-v-8967bb24> AWS is the uncontested source of truth for AWS state. And so Monad uses the AWS Api for truth. </p><p data-v-8967bb24> Monad manages a deterministic set of shapes in AWS and does not need to grapple with arbitrary resource schema migration. </p><h5 data-v-8967bb24>No Yaml</h5><p data-v-8967bb24> At run-time Monad derives it&#39;s configuration from available surrounding resources such as git, AWS caller identity and target AWS account information. </p><h5 data-v-8967bb24>Minimal</h5><p data-v-8967bb24> Optionally provided configuration files are simply JSON request bodies documented extensively by AWS. </p><h5 data-v-8967bb24>DRY</h5><p data-v-8967bb24> Optionally provided configuration is always passed through a templating engine containing a utilitarian set of variables designed for cross-account compatibility. </p><h5 data-v-8967bb24>Least Privilege</h5><p data-v-8967bb24> Monad follows the principle of least privilege, ensuring all services are hermetically constrained by default. Adjusting permissions is easy, auditable, and granular to the needs of services and teams. </p>',23)]))}const R=c(j,[["render",q],["__scopeId","data-v-8967bb24"]]),E={props:{language:{type:String,required:!1,default:"bash"},code:{type:String,required:!0}},mounted(){this.highlightCode()},watch:{code(){this.highlightCode()}},methods:{highlightCode(){this.$el.querySelectorAll("pre code").forEach(e=>{A.highlightElement(e)})}}};function G(i,e,a,l,n,s){return u(),p("div",null,[t("pre",null,[t("code",{class:z(a.language)},`
`+w(a.code)+`
        `,3)])])}const m=c(E,[["render",G]]),Z={components:{Code:m},data(){return{brew:f`
brew tap bkeane/tools
brew install bkeane/tools/monad
            `,action:f`
- uses: bkeane/monad-action@v1
            `}}},X={class:"grid"},W={class:"grid"};function T(i,e,a,l,n,s){const o=d("Code");return u(),p("div",null,[e[2]||(e[2]=t("h2",null,"Install",-1)),e[3]||(e[3]=t("h4",null,[v("Homebrew ("),t("a",{href:"https://github.com/bkeane/monad/releases"},"releases"),v(")")],-1)),t("div",X,[r(o,{code:n.brew},null,8,["code"]),e[0]||(e[0]=t("div",null,null,-1))]),e[4]||(e[4]=t("h4",null,[v("Github Actions ("),t("a",{href:"https://github.com/marketplace/actions/monad-action"},"releases"),v(")")],-1)),t("div",W,[r(o,{code:n.action},null,8,["code"]),e[1]||(e[1]=t("div",null,null,-1))])])}const N=c(Z,[["render",T]]),U={props:{columns:{type:Array,required:!0}}},V={class:"grid"};function F(i,e,a,l,n,s){return u(),p("div",V,[(u(!0),p(M,null,D(a.columns,o=>(u(),p("div",{key:o},[t("h4",null,w(o),1)]))),128))])}const _=c(U,[["render",F]]),Y={props:{png:{type:String,required:!0}}},Q=["src"];function H(i,e,a,l,n,s){return u(),p("div",null,[t("img",{src:a.png},null,8,Q)])}const P=c(Y,[["render",H],["__scopeId","data-v-5b9bf001"]]),L="/monad/assets/git-graph-1-BLbbkDOH.png",J={props:{git:{type:{owner:String,repo:String,service:String,branch:String,sha:String},required:!0}},components:{Header:_,Code:m,Diagram:P},data(){return{png:L,code:f`
git init
git add origin https://github.com/${this.git.owner}/${this.git.repo}
git checkout -b ${this.git.branch}
monad init <language>
            `}}},ee={class:"grid"};function te(i,e,a,l,n,s){const o=d("Code"),b=d("Diagram");return u(),p("div",null,[e[0]||(e[0]=t("h2",null,"Init",-1)),t("div",ee,[r(o,{code:n.code},null,8,["code"]),r(b,{png:n.png},null,8,["png"])])])}const ne=c(J,[["render",te]]),oe={components:{Code:m},data(){return{code:f`
docker build -t $(monad --service <name> ecr tag) --push .`}}},ae={class:"grid"};function re(i,e,a,l,n,s){const o=d("Code");return u(),p("div",ae,[t("div",null,[e[0]||(e[0]=t("h2",null,"Publish",-1)),r(o,{code:n.code},null,8,["code"])]),e[1]||(e[1]=t("div",null,null,-1))])}const se=c(oe,[["render",re]]),ie="data:image/png;base64,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",le="/monad/assets/deployment-webserver-1-CypagEGu.png",de="/monad/assets/deployment-worker-1-DL4hhcfV.png",ue="/monad/assets/deployment-combo-1-Sh92kApQ.png",pe={components:{Header:_,Code:m,Diagram:P},props:{git:{type:{owner:String,repo:String,service:String,branch:String},required:!0},resource:{type:{name:String,path:String,image:String,logGroup:String,tags:Object},required:!0}},data(){return{diagrams:[{title:"Function",command:"monad --service <name> deploy",gateway:!1,rule:!1,png:ie},{title:"Webserver",command:"monad --service <name> deploy --api $api_gateway_name",gateway:!0,rule:!1,png:le},{title:"Worker",command:"monad --service <name> deploy --rule file://rule.json",gateway:!1,rule:!0,png:de},{title:"Webserver + Worker",command:"monad --service <name> deploy --rule file://rule.json --api $api_gateway_name",gateway:!0,rule:!0,png:ue}]}}},ce={class:"grid"};function me(i,e,a,l,n,s){const o=d("Header"),b=d("Code"),h=d("Diagram");return u(),p("div",null,[e[0]||(e[0]=t("h2",null,"Deploy",-1)),(u(!0),p(M,null,D(n.diagrams,g=>(u(),p("div",{key:g.title},[r(o,{columns:[g.title,""]},null,8,["columns"]),t("div",ce,[r(b,{code:g.command,title:g.title},null,8,["code","title"]),r(h,{png:g.png},null,8,["png"])])]))),128))])}const ge=c(pe,[["render",me]]),be={components:{Code:m}},fe={class:"grid"};function ve(i,e,a,l,n,s){const o=d("Code");return u(),p("div",fe,[t("div",null,[e[0]||(e[0]=t("h2",null,"Destroy",-1)),r(o,{code:"monad --service <name> destroy"})]),e[1]||(e[1]=t("div",null,null,-1))])}const he=c(be,[["render",ve]]),ye={components:{Code:m},data(){return{code:f`
monad -h
            `}}},Ae={class:"grid"};function we(i,e,a,l,n,s){const o=d("Code");return u(),p("div",Ae,[t("div",null,[e[0]||(e[0]=t("h2",null,"And more...",-1)),r(o,{code:n.code},null,8,["code"])]),e[1]||(e[1]=t("div",null,null,-1))])}const Me=c(ye,[["render",we]]),De={components:{Install:N,Init:ne,Publish:se,Deploy:ge,Destroy:he,More:Me},data(){return{git:{owner:"owner",repo:"repo",branch:"example",sha:"abd50b21",service:"service"},resource:{name:"",path:"",image:"",logGroup:"",route:"",tags:{}}}},created(){this.initializeData()},methods:{initializeData(){const{branch:i,sha:e,repo:a,service:l,owner:n}=this.git;this.resource={name:`${a}-${i}-${l}`,path:`/${a}/${i}/${l}`,image:`${n}/${a}/${l}:${i}`,logGroup:`/aws/lambda/${a}/${i}/${l}`,route:`/${a}/${i}/${l}/{proxy+}`,tags:{Monad:!0,Branch:i,Sha:e,Service:l,Owner:n,Repo:a}}}}};function _e(i,e,a,l,n,s){const o=d("Install"),b=d("Init"),h=d("Publish"),g=d("Deploy"),y=d("Destroy"),k=d("More");return u(),p("div",null,[r(o,{git:n.git},null,8,["git"]),r(b,{git:n.git},null,8,["git"]),r(h),r(g,{git:n.git,resource:n.resource},null,8,["git","resource"]),r(y),r(k)])}const Pe=c(De,[["render",_e]]),ke={name:"Policy",components:{Code:m},data(){return{policy:"monad deploy --policy file://policy.json",trust:"monad deploy --role file://trust.json"}}};function Oe(i,e,a,l,n,s){const o=d("Code");return u(),p("div",null,[e[0]||(e[0]=t("h3",null,"IAM",-1)),e[1]||(e[1]=t("p",null," By default monad will deploy your lambda function with minimum role and policy adequate for execution. ",-1)),e[2]||(e[2]=t("h5",null,"Custom Policy",-1)),t("p",null,[r(o,{code:n.policy,language:"bash"},null,8,["code"])]),e[3]||(e[3]=t("p",{class:"doc-ref"},[t("a",{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_statement.html"},"Policy Structure"),t("br"),t("a",{href:"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-rule-conditions.html"},"Policy Simulator"),t("br"),t("a",{href:"https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html"},"Actions, Resources & Conditions")],-1)),e[4]||(e[4]=t("h5",null,"Custom Role Policy",-1)),t("p",null,[r(o,{code:n.trust,language:"bash"},null,8,["code"])]),e[5]||(e[5]=t("p",{class:"doc-ref"},[t("a",{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html"},"Role Documentation")],-1))])}const ze=c(ke,[["render",Oe],["__scopeId","data-v-95953f7e"]]),Ce={name:"EventBridge",components:{Code:m},data(){return{rule:"monad deploy --rule file://rule.json",bus:"monad deploy --bus myBus --rule file://rule.json"}}};function Se(i,e,a,l,n,s){const o=d("Code");return u(),p("div",null,[e[0]||(e[0]=t("h3",null,"EventBridge",-1)),e[1]||(e[1]=t("p",null," To wire up your lambda function to be invoked by eventbridge events you can provide both a bus and rule. ",-1)),e[2]||(e[2]=t("h5",null,"Rule",-1)),t("p",null,[r(o,{code:n.rule,language:"bash"},null,8,["code"])]),e[3]||(e[3]=t("p",{class:"doc-ref"},[t("a",{href:"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-rule-conditions.html"},"Rule Documentation"),t("br"),t("a",{href:"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-event-pattern-sandbox.html"},"Rule Sandbox")],-1)),e[4]||(e[4]=t("h5",null,"Bus",-1)),t("p",null,[r(o,{code:n.bus,language:"bash"},null,8,["code"])]),e[5]||(e[5]=t("p",{class:"doc-ref"},[t("a",{href:"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-event-bus.html"},"Bus Documentation")],-1))])}const $e=c(Ce,[["render",Se],["__scopeId","data-v-9aa68011"]]),Ie={name:"ApiGateway",components:{Code:m},data(){return{mount:"monad deploy --api $api_id_or_name",authorizers:"monad deploy --api name --auth $authorizer_id_or_name",curl:"curl https://$api_gateway_url/${repo}/${branch}/${service}/"}}};function Be(i,e,a,l,n,s){const o=d("Code");return u(),p("div",null,[e[0]||(e[0]=t("h3",null,"API Gateway V2",-1)),e[1]||(e[1]=t("p",null," To reverse proxy https traffic to your lambda function you can provide it an HTTP API Gateway V2 on which to mount. ",-1)),e[2]||(e[2]=t("h5",null,"Mount",-1)),t("p",null,[r(o,{code:n.mount,language:"bash"},null,8,["code"])]),e[3]||(e[3]=t("p",{class:"doc-ref"},[t("a",{href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-set-up-simple-proxy.html"},"Greedy Proxies"),t("br"),t("a",{href:"https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/proxy-load-balancer?view=aspnetcore-9.0"},"X-Forwarded-Prefix")],-1)),e[4]||(e[4]=t("h5",null,"Authorizors",-1)),t("p",null,[r(o,{code:n.authorizers,language:"bash"},null,8,["code"])]),e[5]||(e[5]=t("p",{class:"doc-ref"},[t("a",{href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-access-control-iam.html"},"IAM Authentication"),t("br"),t("a",{href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-jwt-authorizer.html"},"JWT Authentication"),t("br"),t("a",{href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-lambda-authorizer.html"},"Custom Authentication")],-1)),e[6]||(e[6]=t("h5",null,"Invoke",-1)),t("p",null,[r(o,{code:n.curl,language:"bash"},null,8,["code"])]),e[7]||(e[7]=t("p",{class:"doc-ref"},[t("a",{href:"https://github.com/okigan/awscurl"},"AWSCurl")],-1))])}const xe=c(Ie,[["render",Be],["__scopeId","data-v-dc803c60"]]),Ke={name:"Environment",components:{Code:m},data(){return{dotenv:"monad deploy --env file://.env",df:f`
COPY --from=raylas/mapenv:latest /bin/mapenv /bin/mapenv
ENTRYPOINT ["/bin/mapenv", "ssm", "-p", "/path/to/env", "--"]
CMD ["./webserver"]
            `}}};function je(i,e,a,l,n,s){const o=d("Code");return u(),p("div",null,[e[0]||(e[0]=t("h3",null,"Environment",-1)),e[1]||(e[1]=t("h5",null,"Non-Sensitive",-1)),e[2]||(e[2]=t("p",null," A dotenv file can be provided to set non-sensitive environment variables. ",-1)),t("p",null,[r(o,{code:n.dotenv,language:"bash"},null,8,["code"])]),e[3]||(e[3]=t("h5",null,"Sensitive",-1)),e[4]||(e[4]=t("p",null," Sensitive environment variables should be provided by alternate means at runtime. ",-1)),t("p",null,[r(o,{code:n.df,language:"dockerfile"},null,8,["code"])]),e[5]||(e[5]=t("p",{class:"doc-ref"},[t("a",{href:"https://git.sr.ht/~raymond/mapenv"},"MapEnv"),t("br"),t("a",{href:"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html"},"Parameter Store"),t("br"),t("a",{href:"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html"},"Secrets Manager")],-1))])}const qe=c(Ke,[["render",je],["__scopeId","data-v-45fe1f5c"]]),Re={name:"Conventions",components:{Code:m},data(){return{tag:"$id.dkr.ecr.$region.amazonaws.com/${owner}/${repo}/${service}:${branch}",entrypoint:f`
            COPY --from=public.ecr.aws/awsguru/aws-lambda-adapter:0.8.4 /lambda-adapter /opt/extensions/lambda-adapter
            ENTRYPOINT ["./webserver"]
            `}}};function Ee(i,e,a,l,n,s){const o=d("Code");return u(),p("div",null,[e[0]||(e[0]=t("h3",null,"OCI",-1)),e[1]||(e[1]=t("p",null," The deployable artifact of Monad is an OCI / Docker image hosted on AWS ECR. ",-1)),e[2]||(e[2]=t("h5",null,"Tag",-1)),e[3]||(e[3]=t("p",null," By default, Monad assumes the tag of your deployable artifact to follow: ",-1)),t("p",null,[r(o,{code:n.tag,language:"bash"},null,8,["code"])]),e[4]||(e[4]=t("h5",null,"Entrypoint",-1)),e[5]||(e[5]=t("p",null,[v(" All service scaffolds provided by "),t("code",null,"monad init"),v(" implement a language agnostic pattern which assumes the entrypoint of your application is a webserver. This approach is not strictly necessary. Monad only holds this as an opinionated core pattern. ")],-1)),t("p",null,[r(o,{code:n.entrypoint,language:"dockerfile"},null,8,["code"])]),e[6]||(e[6]=t("p",{class:"doc-ref"},[t("a",{href:"https://github.com/awslabs/aws-lambda-web-adapter"},"AWS Lambda Web Adapter")],-1))])}const Ge=c(Re,[["render",Ee],["__scopeId","data-v-09b251a5"]]),Ze={name:"Dive",components:{IAM:ze,EventBridge:$e,ApiGateway:xe,Environment:qe,OCI:Ge}};function Xe(i,e,a,l,n,s){const o=d("OCI"),b=d("Environment"),h=d("IAM"),g=d("EventBridge"),y=d("ApiGateway");return u(),p("div",null,[e[0]||(e[0]=t("h2",null,"Dive",-1)),r(o),r(b),r(h),r(g),r(y)])}const We=c(Ze,[["render",Xe]]),Te={class:"content"},Ne={__name:"App",setup(i){const e={"/design":R,"/usage":Pe,"/dive":We},a=C(window.location.hash);window.addEventListener("hashchange",()=>{a.value=window.location.hash});const l=S(()=>e[a.value.slice(1)||"/design"]||NotFound);return(n,s)=>(u(),p("div",Te,[s[0]||(s[0]=t("nav",null,[t("ul",null,[t("li",null,[t("h1",null,"Monad")])]),t("ul",null,[t("li",null,[t("a",{class:"contrast",href:"#/design"},"Design")]),t("li",null,[t("a",{class:"contrast",href:"#/usage"},"Usage")]),t("li",null,[t("a",{class:"contrast",href:"#/dive"},"Dive")])])],-1)),(u(),$(I(l.value)))]))}},Ue=c(Ne,[["__scopeId","data-v-ac1de927"]]);A.registerLanguage("bash",x);A.registerLanguage("dockerfile",K);B(Ue).mount("#app");
